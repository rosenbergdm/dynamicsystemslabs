####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 1a#################################################### Different scales used to determine stability of fixed pointscurve(10*x*(x/20-1)*(1-x/200), from=-500, to=500, main='f(N)=10N(N/20-1)*(1-N/200)', sub="melissa runfeldt. Ch3.1a" ,xlab='N',ylab='f(N)');abline(h=0)abline(v=0)curve(10*x*(x/20-1)*(1-x/200), from=-20, to=30, main='f(N)=10N(N/20-1)*(1-N/200)',xlab='N',ylab='f(N)');abline(h=0)abline(v=0)curve(10*x*(x/20-1)*(1-x/200), xlim=c(-20,400),ylim=c(0,2500), main='f(N)=10N(N/20-1)*(1-N/200)',xlab='N',ylab='f(N)');abline(h=0)abline(v=0)##Fixed points for f(N):N=0		STABLEN=U		UNSTABLEN=K		STABLE###curve(10*x^2*(1-x/200), from=-500, to=500, main='g(N)=10N^2(1-N/200)',sub="melissa runfeldt. Ch3.1a",xlab='N',ylab='g(N)');abline(h=0)abline(v=0)curve(10*x^2*(1-x/200), xlim=c(-20,400),ylim=c(0,2500), main='g(N)=10N^2(1-N/200)',sub="melissa runfeldt. Ch3.1a",xlab='N',ylab='g(N)');abline(h=0)abline(v=0)##Fixed points for g(N):N=0		SEMI-STABLEN=K		STABLE####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 1b###################################################FUNCTIONS PLOTTED ABOVE (1a)#f(N):#From -infinity->0 :Growth (not biologically relevant) #From 0 -> 20 		:Decay#From 20 -> 200 		:Growth#From 200 -> inifinity	:Decay#g(N):#From -infinity-> 0    :Growth (not biologically relevant) #From 0 -> 200         :Growth#From 200 -> inifinity :Decay####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 1c###################################################Polulations below 0 are biologically irrelevant, so we will igore them.#For both functions, the population decays beyond 200.#This can be viewed as an environmental limit, such as food supply. #Once the populations exceed this limit, there are more deaths than birth.#The critical difference between the two functions is that f(N) decays from 0#to 20. This could be annalagous as, say, a pack of wolves that requires a#certain amount of individuals in the pack to be able to aquire food. #If there are less than 20 wolves, the pack is unsufficient in number to catch#enough prey to sustain growth of the pack. #This boundary is not applicable to g(N), which  could be viewed as a culture#of bacteria that continues to grow in size until they eat all of the food on #the plate (limit=200), and then they start to die-off.####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 2a#################################################### dN/dt=rN-sin(4t/2pi)####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 2b#################################################### Finding fixed point:  dN/dt=rN-sin(4t/2pi)=0## Fixed point: N=(1/r)*sin(2t/pi)# If r=1: dN/dt = (4*sin(2*x/pi))-sin(2*x/pi)# f<-function(x){return (sin(2*x/pi));}## curve((4*sin(2*x/pi))-sin(2*x/pi), from=0, to=4*pi)## Using graphical analysis: fixed point N=(1/r)*sin(2t/pi)is UNSTABLE####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 2c##################################################fun<-function(x,t){	return(x-sin(2*t/pi))	}	tRange<-c(0,20)	dt<-5	xRange<-c(-10,10)	dx<-5	h<-0.5	k<-5	tSteps<-diff(range(tRange))/dt	xSteps<-diff(range(xRange))/dx	plot(c(0,20),c(-10,10),type='n',	main='Bacterial Growth ODE Direction Field',xlab='t',	sub='melissa runfeldt. Ch3#2c',	xaxs='i',ylab='N',fg=gray(0.6),yaxs='i')	for(ii in 0:(tSteps-1)){		for(jj in 0:(xSteps-1)){			t<-ii*dt			x<-jj*dx			m<-f(x,t);			u<-t+(h*dt)			v<-x+(k*h*dt)*m			arrows(t,x,u,v,code=2,			length=0.09)			}			}####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 2d################################################### dN/dt=rN-sin(4t/2pi)# dN/dt - rN = -sin(2t/pi)#Using general solution for inhomogenous ODE:# x(t)= exp(\int(a(t)dt) * \int [b(t)* exp(\int(-a(t)dt) dt]         + C*exp(\int(a(t)dt)#where:# a(t)N= rN :   r=1   so a(t)N= 1# b(t) = -sin(4t/2pi) = -sin(2t/pi)We have:# e^(\int(N) dN) = e^t# \int(-sin(2t/pi) * e^-t) dt = [-pi*e^-t * (pi*sin(2*t/pi) + 2* cos(2*t/pi))]                               / (pi^2+4)# N(t)= (pi^2 + 4) * C * exp(t) - pi^2 * sin(2*t/pi) - 2 * pi * cos(2*t/pi)0)                            	/ (pi^2+4)####plot####C1<-0C2<-2*piC3<- 5curve((pi^2 + 4)*C1*exp(x)-pi^2*sin(2*x/pi)-2*pi*cos(2*x/pi)/(pi^2+4), from=0, to=4*pi, main="Initial value = 0",sub="melissa runfeldt. Ch3.2d",xlab='t',ylab='N')curve((pi^2 + 4)*C2*exp(x)-pi^2*sin(2*x/pi)-2*pi*cos(2*x/pi)/(pi^2+4), from=0, to=4*pi,main="Initial value = 2pi",sub="melissa runfeldt. Ch3.2d",xlab='t',ylab='N')curve((pi^2 + 4)*C3*exp(x)-pi^2*sin(2*x/pi)-2*pi*cos(2*x/pi)/(pi^2+4), from=0, to=4*pi,main="Initial value = 5",sub="melissa runfeldt. Ch3.2d",xlab='t',ylab='N')####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 3a###################################################dV/dt=[-1(V-58.1)-100(V+69.6)]/0.15=-673.33V-46012.67###!!!!So I'm going to divide by 10 to make life easier, to give:### dV/dt=-6.73V-460.12#-6.73V-460.12=0#Fixed Point: V=-68.336#V''=-6.73	< 0		: Fixed Point is stablecurve(-6.73*x-460.12,xlim=c(-100,50),ylim=c(-500,100), main='Change in voltage across membrane',sub="melissa runfeldt. Ch3#3a",xlab='V',ylab='dV/dt');abline(v=0, col='red')abline(h=0, col='red')####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 3b##################################################f<-function(x,t){	return((-6.73*x)-460.12)	}	tRange<-c(-100,50)	dt<-5	xRange<-c(-100,150)	dx<-5	h<-0.5	k<-0.5	tSteps<-diff(range(tRange))/dt	xSteps<-diff(range(xRange))/dx	plot(c(-100,50),c(-100,50),type='n',	main='Membrane voltage:Direction Plot',xlab='t',	sub='melissa runfeldt. Ch3#3b',	xaxs='i',ylab='V',fg=gray(0.6),yaxs='i')	for(ii in -110:(tSteps-1)){		for(jj in -110:(xSteps-1)){			t<-ii*dt			x<-jj*dx			m<-f(x,t);			u<-t+(h*dt)			v<-x+(k*h*dt)*m			arrows(t,x,u,v,code=2,			length=0.09)			}			}####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 3c###################################################dV/dt=-6.73V-460.12##V(t)=-68.3685+C*e^-6.73t#V(0)=V0=0 : C=V0+68.3685#V(t)=-68.3685+(V0+68.3685)*e^-6.73t#Initial point = 0V01<-0curve(-68.3685+(V01+68.3685)*exp(-6.73*x),xlim=c(-5,100),ylim=c(-100,100),main='Voltage vs. Time:x0=0, V0=0',sub="melissa runfeldt. Ch3 #3c",xlab='Time',ylab='Voltage');abline(v=0, col='red')abline(h=0, col='red')#Initial point = 100V02<-100curve(-68.3685+(V02+68.3685)*exp(-6.73*x),xlim=c(-5,100),ylim=c(-100,100),main='Voltage vs. Time:x0=0, V0=100',sub="melissa runfeldt. Ch3 #3c0",xlab='Time',ylab='Voltage');abline(v=0, col='red')abline(h=0, col='red')#Initial point = -100V03<--150curve(-68.3685+(V03+68.3685)*exp(-6.73*x),xlim=c(-5,100),ylim=c(-100,100),main='Voltage vs. Time:x0=0, V0=-100',sub="melissa runfeldt. Ch3 #3c0",xlab='Time',ylab='Voltage');abline(v=0, col='red')abline(h=0, col='red')### No matter what the initial value is, the model will always move towards#the fixed point, which is the resting membrane potential in this model. #This conclusion can be reached several ways, like looking at solution graph#or solving analytically.####################################################Name: Melissa Runfeldt##Assignment: Ch3 lab exercise##Problem 4################################################### Fixed points : x/3(1-x/5) = 0 ; x=5, 0fun<-function(x,t){return(x/3*(1-x/5));}curve (x/3*(1-x/5), xlim=c(-4,8),ylim=c(-4,4), main='x/3*(1-x/5)',sub="melissa runfeldt. Ch3 #4", xlab='t',ylab='f(x,t)' )abline(h=0)abline(v=0)arrows (0,0,-4,0, col='red')arrows (0,0,5,0, col='red')arrows (8,0,5,0,col='red')